<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Relatório IGEPE</title>
    <link href="https://unpkg.com/tabulator-tables@5.5.2/dist/css/tabulator.min.css" rel="stylesheet">
    <script type="text/javascript" src="https://unpkg.com/tabulator-tables@5.5.2/dist/js/tabulator.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f8fafc;
            color: #334155;
            line-height: 1.5;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 30px 20px;
        }
        
        .header-container {
            margin-bottom: 40px;
            padding: 30px;
            background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
            color: white;
            border-radius: 12px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        
        .header-container h1, .header-container h2 {
            margin: 0;
            padding: 0;
        }
        
        .header-container h1 {
            font-size: 32px;
            margin-bottom: 10px;
            font-weight: 700;
            letter-spacing: -0.5px;
        }
        
        .header-container h2 {
            font-size: 18px;
            font-weight: 400;
            margin-bottom: 6px;
            opacity: 0.9;
        }
        
        .report-title {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 25px;
            color: #1e293b;
            padding-bottom: 15px;
            border-bottom: 1px solid #e2e8f0;
        }
        
        #tabela-relatorio {
            box-shadow: 0 6px 18px rgba(0, 0, 0, 0.08);
            border-radius: 12px;
            overflow: hidden;
            background-color: white;
            margin-bottom: 40px;
        }
        
        .tabulator {
            border: none;
            font-size: 14px;
            font-family: 'Inter', sans-serif;
        }
        
        .tabulator .tabulator-header {
            border-bottom: 2px solid #3b82f6;
            background: linear-gradient(to bottom, #f8fafc, #f1f5f9);
            color: #1e293b;
            font-weight: 600;
            font-size: 14px;
        }
        
        .tabulator .tabulator-header .tabulator-col {
            background-color: transparent;
            border-right: 1px solid #e2e8f0;
        }
        
        .tabulator .tabulator-header .tabulator-col .tabulator-col-content {
            padding: 14px 12px;
            font-weight: 600;
        }
        
        .tabulator .tabulator-tableholder .tabulator-table .tabulator-row {
            background-color: transparent;
            border-bottom: 1px solid #f1f5f9;
        }
        
        .tabulator .tabulator-tableholder .tabulator-table .tabulator-row .tabulator-cell {
            border-right: 1px solid #f1f5f9;
            padding: 12px 14px;
        }
        
        /* Garantir alinhamento das células em todas as linhas */
        .tabulator-cell {
            text-align: right !important;
        }
        
        .tabulator-cell:first-child {
            text-align: left !important;
        }
        
        .tabulator-row.ativos-correntes {
            background-color: #f8fafc !important;
        }
        
        .tabulator-row.ativos-nao-correntes {
            background-color: transparent;
        }
        
        .tabulator-row.grupo-principal {
            font-weight: 700;
            background-color: #1e293b !important;
            color: white;
            font-size: 16px;
            letter-spacing: 0.3px;
        }
        
        .tabulator-row.subgrupo {
            font-weight: 600;
            background-color: #f1f5f9 !important;
            color: #1e293b;
            font-size: 15px;
        }
        
        .tabulator-row.item {
            font-weight: 400;
        }
        
        .tabulator-row.total {
            font-weight: 600;
            border-top: 2px solid #cbd5e1;
            background-color: #f8fafc !important;
            color: #1e293b;
        }
        
        .tabulator-row:hover {
            background-color: #f0f9ff !important;
        }
        
        .tabulator-row.grupo-principal:hover {
            background-color: #334155 !important;
        }
        
        .tabulator-row.subgrupo:hover {
            background-color: #e2e8f0 !important;
        }
        
        .valor-negativo {
            color: #dc2626;
            font-weight: 500;
        }
        
        .valor-positivo {
            color: #1e293b;
            font-weight: 500;
        }
        
        .footer {
            text-align: center;
            padding: 20px;
            color: #64748b;
            font-size: 14px;
            border-top: 1px solid #e2e8f0;
            margin-top: 30px;
        }
        
        .info-box {
            background: #f0f9ff;
            border-left: 4px solid #3b82f6;
            padding: 16px 20px;
            margin-bottom: 25px;
            border-radius: 0 8px 8px 0;
            font-size: 14px;
            color: #1e293b;
        }
        
        /* Estilo para indentação dos itens */
        .item-indent {
            padding-left: 30px !important;
        }
        
        /* Garantir que os totais tenham o mesmo alinhamento */
        .tabulator-row.total .tabulator-cell {
            font-weight: 700;
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .header-container {
                padding: 20px;
            }
            
            .header-container h1 {
                font-size: 26px;
            }
            
            .tabulator .tabulator-header .tabulator-col .tabulator-col-content {
                padding: 10px 8px;
                font-size: 13px;
            }
            
            .tabulator .tabulator-tableholder .tabulator-table .tabulator-row .tabulator-cell {
                padding: 10px 8px;
                font-size: 13px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header-container">
            <h1>IGEPE</h1>
            <h2>CENTRO DE LEGISLAMENTO SEGUINTE</h2>
            <h2>Balanço</h2>
        </div>
        
        <div class="info-box">
            Este relatório apresenta o balanço financeiro com detalhamento dos activos correntes e não correntes.
        </div>
        
        <div class="report-title">Relatório Financeiro Detalhado</div>
        
        <div id="tabela-relatorio"></div>
        
        <div class="footer">
            Relatório gerado em 2023 | IGEPE - Instituto de Gestão das Participações do Estado
        </div>
    </div>

    <script>
        
        // Dados para a tabela
        var tableData = [
            { descricao: "ACTIVOS", A2022: "", ND: "", variacao: "", variacaoPercent: "", nivel: "principal" },
            
            { descricao: "Activos correntes", A2022: "", ND: "", variacao: "", variacaoPercent: "", nivel: "subgrupo", classe: "ativos-correntes" },
            { descricao: "Inventários", A2022: "13 098 600 578.17", ND: "0.00", variacao: "13 098 600 578.17", variacaoPercent: "", nivel: "item" },
            { descricao: "Activos biológicos", A2022: "0.00", ND: "0.00", variacao: "0.00", variacaoPercent: "0", nivel: "item" },
            { descricao: "Clientes", A2022: "38 550 426 756.25", ND: "0.00", variacao: "38 550 426 756.25", variacaoPercent: "", nivel: "item" },
            { descricao: "Outros activos financeiros", A2022: "0.00", ND: "0.00", variacao: "0.00", variacaoPercent: "0", nivel: "item" },
            { descricao: "Outros activos correntes", A2022: "58 938 683 101.17", ND: "0.00", variacao: "58 938 683 101.17", variacaoPercent: "", nivel: "item" },
            { descricao: "Caixa e bancos", A2022: "58 090 014 044.90", ND: "0.00", variacao: "58 090 014 044.90", variacaoPercent: "", nivel: "item" },
            { descricao: "Activos não correntes detidos para venda", A2022: "267 111 300.00", ND: "0.00", variacao: "267 111 300.00", variacaoPercent: "", nivel: "item" },
            { descricao: "Total- Activos correntes", A2022: "168 944 835 780.49", ND: "0.00", variacao: "168 944 835 780.49", variacaoPercent: "", nivel: "total" },
            
            { descricao: "Activos não correntes", A2022: "", ND: "", variacao: "", variacaoPercent: "", nivel: "subgrupo", classe: "ativos-nao-correntes" },
            { descricao: "Activos tangíveis", A2022: "391 433 875 825.82", ND: "0.00", variacao: "391 433 875 825.82", variacaoPercent: "", nivel: "item" },
            { descricao: "Activos tangíveis de investimento", A2022: "13 620 279 102.37", ND: "0.00", variacao: "13 620 279 102.37", variacaoPercent: "", nivel: "item" },
            { descricao: "Goodwill", A2022: "73 808 085.20", ND: "0.00", variacao: "73 808 085.20", variacaoPercent: "", nivel: "item" },
            { descricao: "Activos intangíveis", A2022: "220 747 032 462.59", ND: "0.00", variacao: "220 747 032 462.59", variacaoPercent: "", nivel: "item" },
            { descricao: "Activos biológicos", A2022: "0.00", ND: "0.00", variacao: "0.00", variacaoPercent: "0", nivel: "item" },
            { descricao: "Investimentos em associadas", A2022: "31 499 049 473.35", ND: "0.00", variacao: "31 499 049 473.35", variacaoPercent: "", nivel: "item" },
            { descricao: "Investimentos em subsidiárias", A2022: "0.00", ND: "0.00", variacao: "0.00", variacaoPercent: "0", nivel: "item" }
        ];

        // Configuração da tabela
        var table = new Tabulator("#tabela-relatorio", {
            data: tableData,
            layout: "fitColumns",
            columns: [
                {
                    title: "Descrição", 
                    field: "descricao", 
                    widthGrow: 2,
                    headerSort: false, 
                    resizable: false,
                    formatter: function(cell, formatterParams, onRendered) {
                        var row = cell.getRow();
                        var nivel = row.getData().nivel;
                        
                        if (nivel === "item") {
                            return "<span class='item-indent'>" + cell.getValue() + "</span>";
                        }
                        var cellElement = cell.getElement(); 

                          //cell.getElement().css({"background-color":"#A6D3A0"});
                            cellElement.style.backgroundColor = "#A6D3A0";
                            cellElement.style.borderRight = "5px solid red";
                        return cell.getValue();
                    },
                    // Forçar alinhamento à esquerda apenas para a coluna de descrição
                    hozAlign: "left"
                },
                {
                    title: "A2022", 
                    field: "A2022", 
                    widthGrow: 1,
                    headerSort: false, 
                    resizable: false,
                    formatter: function(cell, formatterParams, onRendered) {
                        var value = cell.getValue();
                        if (value && value !== "") {
                            return "<span class='valor-positivo'>" + value + "</span>";
                        }
                        return value;
                    },
                    // Forçar alinhamento à direita para todas as colunas numéricas
                    hozAlign: "right"
                },
                {
                    title: "N/D", 
                    field: "ND", 
                    widthGrow: 1,
                    headerSort: false, 
                    resizable: false,
                    hozAlign: "right"
                },
                {
                    title: "Variação", 
                    field: "variacao", 
                    widthGrow: 1,
                    headerSort: false, 
                    resizable: false,
                    formatter: function(cell, formatterParams, onRendered) {
                        var value = cell.getValue();
                        if (value && value !== "" && value !== "0.00") {
                            return "<span class='valor-positivo'>" + value + "</span>";
                        }
                        return value;
                    },
                    hozAlign: "right"
                },
                {
                    title: "Variação(%)", 
                    field: "variacaoPercent", 
                    widthGrow: 1,
                    headerSort: false, 
                    resizable: false,
                    formatter: function(cell, formatterParams, onRendered) {
                        var value = cell.getValue();
                        if (value && value !== "" && value !== "0") {
                            return "<span class='valor-positivo'>" + value + "%</span>";
                        }
                        return value;
                    },
                    hozAlign: "right"
                }
            ],
            rowFormatter: function(row) {
                var data = row.getData();
                var nivel = data.nivel;
                var classe = data.classe || "";
                
                if (nivel === "principal") {
                    row.getElement().classList.add("grupo-principal");
                } else if (nivel === "subgrupo") {
                    row.getElement().classList.add("subgrupo");
                    if (classe) {
                        row.getElement().classList.add(classe);
                    }
                } else if (nivel === "item") {
                    row.getElement().classList.add("item");
                } else if (nivel === "total") {
                    row.getElement().classList.add("total");
                }
            }
        });


    </script>
</body>
</html>